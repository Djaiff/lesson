# Structure d'une application

## Structure d'une application | Un seul fichier

- enregistré sous le nom __app.R__
- se terminant par la commande shinyApp()
- pour les applications légères

<div style="text-align:center" markdown="1">
<img src="img/single_app.png" alt="Drawing" style="width: 70%;">
</div>

## Structure d'une application | Un seul fichier

```{r, eval = FALSE}
library(shiny)
ui <- fluidPage(
  sliderInput(inputId = "num", label = "Choose a number", 
              value = 25, min = 1, max = 100),  
  plotOutput("hist")
)
server <- function(input, output) {  
  output$hist <- renderPlot({
    hist(rnorm(input$num))  
  }) 
}
shinyApp(ui = ui, server = server)
```

## Structure d'une application | deux fichiers

- côté interface utilisateur dans le script __ui.R__
- côté serveur dans le script __server.R__

<div style="text-align:center" markdown="1">
<img src="img/dual_apps.png" alt="Drawing" style="width: 70%;">
</div>

## Structure d'une application | deux fichiers

__ui.R__
```{r, eval = FALSE}
library(shiny)
fluidPage(
  sliderInput(inputId = "num", label = "Choose a number", 
              value = 25, min = 1, max = 100),  
  plotOutput("hist")
)
```

__server.R__
```{r, eval = FALSE}
library(shiny)
function(input, output) {  
  output$hist <- renderPlot({hist(rnorm(input$num))}) 
}
```

## Structure d'une application | UI en HTML

Même si en général on code le __UI__ dans un __script R__, il est également possible de le coder entièrement dans un fichier __.html__. Plus d'informations [ici](http://shiny.rstudio.com/articles/html-ui.html)

- côté interface utilisateur, un fichier __index.html__ dans le répertoire ``www``
- côté serveur dans le script __server.R__

<div style="text-align:center" markdown="1">
<img src="img/html_apps.png" alt="Drawing" style="width: 40%;">
</div>


## Structure d'une application | données/fichiers complémentaires

- le code __R__ tourne au niveau des scripts __R__, et peut donc accéder de façon relative à tous les objets présents dans le dossier de l'application
- l'application web, comme de convention, accède à tous les éléments présents dans le dossier ``www``

<div style="text-align:center" markdown="1">
<img src="img/more_apps.png" alt="Drawing" style="width: 70%;">
</div>

## Structure d'une application | Partage ui <-> server

__Le server et l'ui communiquent uniquement par le biais des inputs et des outputs__

- Nous pouvons ajouter un script nommé **global.R** pour partager des éléments (variables,  packages, ...) entre la partie __UI__ et la partie __SERVER__ 

- Tout ce qui est présent dans le **global.R** est visible à la fois dans le __ui.R__ et dans le __server.R__

- Le script **global.R** est chargé uniquement une seul fois au lancement de l'application

- Dans le cas d'une utilisation avec un ``shiny-server``, les objets globaux sont également partagés entre les utilisateurs